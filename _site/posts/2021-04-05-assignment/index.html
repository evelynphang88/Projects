<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>Evelyn's Blog: Visualisation for Stock Performance Analysis</title>

<meta property="description" itemprop="description" content="ISS 608- Visual Analytics Assignment : Stock Analysis - Visualisations- A short exploration of TidyQuant with ggplot2"/>


<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-04-05"/>
<meta property="article:created" itemprop="dateCreated" content="2021-04-05"/>
<meta name="article:author" content="EvelynPhang"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Evelyn&#39;s Blog: Visualisation for Stock Performance Analysis"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="ISS 608- Visual Analytics Assignment : Stock Analysis - Visualisations- A short exploration of TidyQuant with ggplot2"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Evelyn&#39;s Blog"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="Evelyn&#39;s Blog: Visualisation for Stock Performance Analysis"/>
<meta property="twitter:description" content="ISS 608- Visual Analytics Assignment : Stock Analysis - Visualisations- A short exploration of TidyQuant with ggplot2"/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","preview","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Visualisation for Stock Performance Analysis"]},{"type":"character","attributes":{},"value":["ISS 608- Visual Analytics Assignment : Stock Analysis - Visualisations- A short exploration of TidyQuant with ggplot2"]},{"type":"character","attributes":{},"value":["tidyquant1.png"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["EvelynPhang"]}]}]},{"type":"character","attributes":{},"value":["04-05-2021"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["code_folding","toc","toc_depth","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]},{"type":"logical","attributes":{},"value":[false]}]}]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["assignment_files/anchor-4.2.2/anchor.min.js","assignment_files/bowser-1.9.3/bowser.min.js","assignment_files/distill-2.2.21/template.v2.js","assignment_files/figure-html5/unnamed-chunk-10-1.png","assignment_files/figure-html5/unnamed-chunk-11-1.png","assignment_files/figure-html5/unnamed-chunk-12-1.png","assignment_files/figure-html5/unnamed-chunk-13-1.png","assignment_files/figure-html5/unnamed-chunk-14-1.png","assignment_files/figure-html5/unnamed-chunk-15-1.png","assignment_files/figure-html5/unnamed-chunk-16-1.png","assignment_files/figure-html5/unnamed-chunk-17-1.png","assignment_files/figure-html5/unnamed-chunk-18-1.png","assignment_files/figure-html5/unnamed-chunk-19-1.png","assignment_files/figure-html5/unnamed-chunk-20-1.png","assignment_files/figure-html5/unnamed-chunk-21-1.png","assignment_files/figure-html5/unnamed-chunk-22-1.png","assignment_files/figure-html5/unnamed-chunk-23-1.png","assignment_files/figure-html5/unnamed-chunk-24-1.png","assignment_files/figure-html5/unnamed-chunk-25-1.png","assignment_files/figure-html5/unnamed-chunk-26-1.png","assignment_files/figure-html5/unnamed-chunk-27-1.png","assignment_files/figure-html5/unnamed-chunk-28-1.png","assignment_files/figure-html5/unnamed-chunk-29-1.png","assignment_files/figure-html5/unnamed-chunk-30-1.png","assignment_files/figure-html5/unnamed-chunk-31-1.png","assignment_files/figure-html5/unnamed-chunk-32-1.png","assignment_files/figure-html5/unnamed-chunk-33-1.png","assignment_files/figure-html5/unnamed-chunk-34-1.png","assignment_files/figure-html5/unnamed-chunk-35-1.png","assignment_files/figure-html5/unnamed-chunk-36-1.png","assignment_files/figure-html5/unnamed-chunk-5-1.png","assignment_files/figure-html5/unnamed-chunk-6-1.png","assignment_files/figure-html5/unnamed-chunk-7-1.png","assignment_files/figure-html5/unnamed-chunk-8-1.png","assignment_files/figure-html5/unnamed-chunk-9-1.png","assignment_files/header-attrs-2.6/header-attrs.js","assignment_files/jquery-1.11.3/jquery.min.js","assignment_files/webcomponents-2.0.0/webcomponents.js","targetshiny.jpg","tidyquant1.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

</style>

<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
            .filter(function(item) { return !!item.description; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description}
                </div>
                <div class="search-item-preview">
                  <img src="${suggestion.preview ? offsetURL(suggestion.preview) : ''}"</img>
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif+JP:300, 300i&display=swap');
@import url('https://fonts.googleapis.com/css?family=Lato:400,400i,700&display=swap');
@import url('https://fonts.googleapis.com/css?family=IBM+Plex+Mono&display=swap');

html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #ca225e;
  --header-color:    #ca225e;                    /* edited */
  --body-color:      #404040;                    /* edited */
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    "Noto Serif JP", sans-serif; /* edited */
  --mono-font:       "IBM Plex Mono", monospace;  /* edited */
  --body-font:       "Lato", sans-serif;          /* edited */
  --navbar-font:     "Lato", sans-serif;          /* edited */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.9rem;                      /* edited */
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.95rem;                     /* edited */
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);      
  --text-size:       0.9rem;                    /* edited */
  --text-color:      #1a162d;                   /* edited */
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       #1f1f1f;                   /* edited */
  --text-size:        15px;
  --hover-color:      #787878;                   /* edited */
  --bkgd-color:       #fff;                      /* edited */
}

.distill-site-footer {
  --text-color:       #7e7b88;                   /* edited */
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #ca225e3d;                 /* edited */
}

/*-- Additional custom styles --*/

ul > li::marker {
  color: #ca225e;
}

.distill-site-header { 
  letter-spacing: 2px;
  text-transform: uppercase;
}

h1, h2, h3, h4, h5, h6 {
  letter-spacing: 2px;
  font-weight: 300;
}

.distill-site-header .logo img{
  max-height: 40px; /* Makes logo bigger, default was 20px */
}

.distill-site-header {
  padding-top: 1rem;
}

d-title h1,
d-article h2,
.posts-list .description h2,
.posts-list > h1 {
    font-weight: 300;
}

d-appendix {
  background-color: #fdf7f9;
  border-top: none;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
	font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
/* only text inside of <p> tags */
d-article > p {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}

/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
	font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
	font-size: var(--aside-size, 12px);
	color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
	font-size: var(--fig-cap-size, 13px);
	color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
	font-size: var(--heading-size, 0.6rem);
	color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
	font-size: var(--body-size, 0.8rem);
	color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
	color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
	font-size: var(--heading-size, 18px);
}

.d-contents nav a {
	font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
	color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
	color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
	color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
	font-size: var(--title-size, 18px);
	font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a:hover {
	color: var(--hover-color, white);
}

.distill-site-header {
	font-size: var(--text-size, 15px);
	color: var(--text-color, rgba(255, 255, 255, 0.8));
	background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
	font-size: var(--text-size, 15px);
	color: var(--text-color, rgba(255, 255, 255, 0.8));
	background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
	color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.6/header-attrs.js"></script>
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Visualisation for Stock Performance Analysis","description":"ISS 608- Visual Analytics Assignment : Stock Analysis - Visualisations- A short exploration of TidyQuant with ggplot2","authors":[{"author":"EvelynPhang","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-04-05T00:00:00.000+08:00","citationText":"EvelynPhang, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Evelyn's Blog</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../about.html">About</a>
<a href="../../dataViz.html">DataViz Makeover</a>
<a href="../../projects.html">Projects</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Visualisation for Stock Performance Analysis</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>ISS 608- Visual Analytics Assignment : Stock Analysis - Visualisations- A short exploration of TidyQuant with ggplot2</p></p>
</div>

<div class="d-byline">
  EvelynPhang  
  
<br/>04-05-2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#background">1.Background</a></li>
<li><a href="#objectivelayout-of-this-assignment">2. Objective/Layout of this assignment</a></li>
<li><a href="#literature-review---why-tidyquant-tidy-quantitative-financial-analysis">3. Literature Review - Why TidyQuant (Tidy Quantitative Financial Analysis)</a></li>
<li><a href="#tidyquant---charting">3.1 TidyQuant - Charting</a></li>
<li><a href="#tidyquant---portfolio-analysis">3.2 TidyQuant - Portfolio Analysis</a></li>
<li><a href="#loading-and-preping-data-single-stock-and-multiple-stock-analysis">4. Loading and Preping Data : Single Stock and Multiple Stock analysis</a></li>
<li><a href="#testing-and-prototyping---single-stock-analysis-using-apple-stock">5.Testing and Prototyping - Single Stock Analysis ( Using APPLE stock)</a></li>
<li><a href="#candlestick-chart">5.1 Candlestick Chart</a></li>
<li><a href="#stock-pricetradingvolumereturns">5.2 Stock Price/TradingVolume/Returns</a></li>
<li><a href="#charting-for-multiple-securities">6. Charting for Multiple Securities</a></li>
<li><a href="#multiple-securities--closing-prices">6.1 Multiple securities -Closing prices</a></li>
<li><a href="#multiple-securities--moving-averages-for-multiple-stocks-at-once">6.2 Multiple securities -Moving averages for multiple stocks at once</a></li>
<li><a href="#multiple-securities--bbands-for-multiple-stocks">6.3 Multiple securities -BBands for multiple stocks</a></li>
<li><a href="#multiple-securities--annural-returns">6.4 Multiple securities -Annural Returns</a></li>
<li><a href="#portfolio-analysis-using-tq_portfolio-function.">6.5 Portfolio Analysis using <strong><em>tq_portfolio</em></strong> function.</a></li>
<li><a href="#miscelleneous-plotting-experiementations">6.6 Miscelleneous Plotting experiementations</a></li>
<li><a href="#ggplot---exploration-of-log-scale-vs-continous-scale-on-y-for-stock-prices">6.6.1 GGPLOT - Exploration of Log Scale vs Continous Scale on Y for stock prices</a></li>
<li><a href="#ggplot---plotting-regression-trendlines-with-geom_smooth">6.6.2 GGPLOT - Plotting Regression trendlines with geom_smooth</a></li>
<li><a href="#reflection--conclusionkey-learningsbenefits-of-interactivity-in-the-shiny-app">7.0 Reflection- Conclusion/Key Learnings/Benefits of Interactivity in the Shiny App</a></li>
<li><a href="#interactive-user-experience-and-self-configuration-of-views">7.1 Interactive User Experience and Self Configuration of views</a></li>
<li><a href="#finer-details---interacing-with-chart-points.">7.2 Finer details - Interacing with Chart Points.</a></li>
<li><a href="#possible-shiny-app-story-board-for-stock-analysis">8.0 Possible SHiny App Story Board for Stock Analysis</a></li>
<li><a href="#references">9.0 References</a></li>
</ul>
</nav>
</div>
<h3 id="background">1.Background</h3>
<p>Many investors analyze stocks based on their fundamentals such as their revenue, valuation, or industry trends but fundamental factors aren’t always reflected in the market price.</p>
<p><strong>Technical analysis</strong> using charts help to identify trading signals and price patterns, and provides as a window into market psychology to identify opportunities to profit.</p>
<p>Project Group Scope : provides various tools for a <strong><em>beginner</em></strong> investor,to analyse stocks past performance and forecasting with 3 parts:<br />
1)Forecasting ( leveraging <strong>ModelTime</strong> package)<br />
2)Visualisations for Stock Performance ( leveraging <strong>TidyQuant</strong> Package)<br />
3)Extensive Time Series analysis ( leveraging <strong>TimeTK</strong>)</p>
<p>** I will be covering part 2).**</p>
<h3 id="objectivelayout-of-this-assignment">2. Objective/Layout of this assignment</h3>
<p>This assignment explores the features of TidyQuant to experiment what is best of the user, and also to identify any gaps that an eventually Shiny App implementation can adderss to improve the user’s experience.</p>
<p>After some research,the following 3 charts provide the most information for the beginner trader to study a <strong>single stock</strong>:</p>
<ul>
<li><ol type="1">
<li>Price Movement - Candlesticks Chart</li>
</ol>
<ul>
<li>This chart reflect the impact of investor sentiment on security prices and are used by technical analysts to determine when to enter and exit trades.</li>
</ul></li>
<li><ol start="2" type="1">
<li>Stock Price and Trading Volume - Line Charts/Bart Charts</li>
</ol>
<ul>
<li>This chart provide the the volumes have been in the past and what they are currently before making a decision.</li>
</ul></li>
<li><ol start="3" type="1">
<li>Moving averages (15-day, 50-day and 200-day) on a particular stock price movement-</li>
</ol>
<ul>
<li>This chart provides information about the moving average. For Liquid/Volatile stocks may benefit from shorter (eg.15-day) moving average analysis where as illiquid stocks my be examined with 50-day moving average.</li>
</ul></li>
</ul>
<p>After some research, the typical four charts that is useful for a trader to analysis of <strong>group of stocks</strong> or <strong>portfolio</strong> :</p>
<ul>
<li><p>1)Closing prices</p></li>
<li><p>2)Moving Average</p></li>
<li><p>3)Bollinger Bands</p></li>
<li><p>4)Annual Returns</p></li>
</ul>
<h3 id="literature-review---why-tidyquant-tidy-quantitative-financial-analysis">3. Literature Review - Why TidyQuant (Tidy Quantitative Financial Analysis)</h3>
<center>
<p><img src="tidyquant1.png" style="width:30.0%" /></p>
</center>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'># Loads tidyquant, lubridate, xts, quantmod, TTR, and PerformanceAnalytics</span>

<span class='va'>packages</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'tidyverse'</span>,<span class='st'>'tidyquant'</span>,<span class='st'>'lubridate'</span>,<span class='st'>'xts'</span>,<span class='st'>'quantmod'</span>,<span class='st'>'TTR'</span>,<span class='st'>'PerformanceAnalytics'</span><span class='op'>)</span>

<span class='kw'>for</span> <span class='op'>(</span><span class='va'>p</span> <span class='kw'>in</span> <span class='va'>packages</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>p</span>,character.only<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>p</span>, character.only<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>TidyQuant addresses a few gaps that in the existing quantitative analysis functions (QAF).</p>
<ul>
<li><p>GAP-1</p>
<ul>
<li>Existing Quantitative analysis functions (QAF) -such as xts, zoo, quantmod, TTR, and PerformanceAnalytics work with time-series objects. These objects do not work well with the data frames or the tidyverse workflow.</li>
</ul></li>
<li><p>SOLUTION- 1 +TidyQuant addresses this by providing a wrapper to enabling seamless usage within the tidyverse workflow.</p></li>
<li><p>GAP-2: Existing QAF functions for Stock Analysis do not provide any easy to use functions to load stock information and stock indices.</p>
<ul>
<li>SOLUTION-2 : TidyQuant addresses this by implementing the following functions :Get a Stock Index, tq_index(), or a Stock Exchange, tq_exchange(): Returns the stock symbols and various attributes for every stock in an index or exchange. Eighteen indexes and three exchanges are available. To get Quantitative Data, tq_get()is implemented to provide a one-stop shop to get data from various web-sources.</li>
</ul></li>
<li><p>GAP-3 : PerformanceAnalytics package consolidates functions to compute many of the most widely used performance metrics.</p>
<ul>
<li>SOLUTION -3 : Tidyquant integrates this functionality so it can be used at scale using the split, apply, combine framework within the tidyverse. Two primary functions integrate the performance analysis functionality:
<ul>
<li>tq_performance implements the performance analysis functions in a tidy way, enabling scaling analysis using the split, apply, combine framework</li>
<li>tq_portfolio provides a useful tool set for aggregating a group of individual asset returns into one or many portfolios.</li>
</ul></li>
</ul></li>
</ul>
<h3 id="tidyquant---charting">3.1 TidyQuant - Charting</h3>
<p>The tidyquant package leverages ggplot2 - and has three primary geometry (geom) categories and one coordinate manipulation (coord) category that i will explore:</p>
<ul>
<li><p><strong><em>Chart Types</em></strong>: Two chart type visualizations are available using geom_barchart and geom_candlestick.</p></li>
<li><p><strong><em>Moving Averages</em></strong>: Seven moving average visualizations are available using geom_ma.</p></li>
<li><p><strong><em>Bollinger Bands</em></strong>: Bollinger bands can be visualized using geom_bbands. The BBand moving average can be one of the seven available in Moving Averages.</p></li>
<li><p><strong><em>Zooming in on Date Ranges</em></strong>:</p>
<ul>
<li>Two coord functions are available (coord_x_date and coord_x_datetime), which prevent data loss when zooming in on specific regions of a chart. This is important when using the moving average and Bollinger band geoms.</li>
</ul></li>
</ul>
<h3 id="tidyquant---portfolio-analysis">3.2 TidyQuant - Portfolio Analysis</h3>
<p>The <strong><em>Performance Analytics</em></strong> package in TidyQuant consolidates functions to compute the most widely used stock performance metrics. Tidquant integrates this functionality so it can be used at scale using the split, apply, combine framework within the tidyverse.</p>
<ul>
<li><p>Two primary functions integrate the performance analysis functionality:</p>
<ul>
<li><p><strong><em>tq_performance</em></strong> - implements the performance analysis functions in a tidy way, enabling scaling analysis using the split, apply, combine framework.</p></li>
<li><p><strong><em>tq_portfolio</em></strong> - provides a useful tool set for aggregating a group of individual asset returns into one or many portfolios.</p></li>
</ul></li>
</ul>
<h3 id="loading-and-preping-data-single-stock-and-multiple-stock-analysis">4. Loading and Preping Data : Single Stock and Multiple Stock analysis</h3>
<p>Tidyquant provides a function tq_get for directly loading data. For the purpose of this assignment i use this funciton to get the data for APPLE, AMAZON, FACEBOOK&lt; GOOGLE, NETFLIX. To preapre for a multi-stock analysis evaluation, i also built combined data set.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AAPL</span> <span class='op'>&lt;-</span> <span class='fu'>tq_get</span><span class='op'>(</span><span class='st'>"AAPL"</span>, get <span class='op'>=</span> <span class='st'>"stock.prices"</span>, from <span class='op'>=</span> <span class='st'>"2011-01-01"</span>, to <span class='op'>=</span> <span class='st'>"2021-03-31"</span><span class='op'>)</span>
<span class='va'>AMZN</span> <span class='op'>&lt;-</span> <span class='fu'>tq_get</span><span class='op'>(</span><span class='st'>"AMZN"</span>, get <span class='op'>=</span> <span class='st'>"stock.prices"</span>, from <span class='op'>=</span> <span class='st'>"2011-01-01"</span>, to <span class='op'>=</span> <span class='st'>"2021-03-31"</span><span class='op'>)</span>
<span class='va'>GOOG</span> <span class='op'>&lt;-</span> <span class='fu'>tq_get</span><span class='op'>(</span><span class='st'>"GOOG"</span>,get <span class='op'>=</span> <span class='st'>"stock.prices"</span>, from <span class='op'>=</span> <span class='st'>"2011-01-01"</span>, to <span class='op'>=</span> <span class='st'>"2021-03-31"</span><span class='op'>)</span>
<span class='va'>NFLX</span> <span class='op'>&lt;-</span> <span class='fu'>tq_get</span><span class='op'>(</span><span class='st'>"NFLX"</span>,get <span class='op'>=</span> <span class='st'>"stock.prices"</span>, from <span class='op'>=</span> <span class='st'>"2011-01-01"</span>, to <span class='op'>=</span> <span class='st'>"2021-03-31"</span><span class='op'>)</span>
<span class='va'>FB</span> <span class='op'>&lt;-</span> <span class='fu'>tq_get</span><span class='op'>(</span><span class='st'>"FB"</span>,get <span class='op'>=</span> <span class='st'>"stock.prices"</span>, from <span class='op'>=</span> <span class='st'>"2011-01-01"</span>, to <span class='op'>=</span> <span class='st'>"2021-03-31"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>FAANG</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>FB</span>,<span class='va'>AAPL</span>,<span class='va'>AMZN</span>,<span class='va'>NFLX</span>,<span class='va'>GOOG</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Setup the End Data for review as last day in March of 2021</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>end</span> <span class='op'>&lt;-</span> <span class='fu'>as_date</span><span class='op'>(</span><span class='st'>"2021-03-31"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="testing-and-prototyping---single-stock-analysis-using-apple-stock">5.Testing and Prototyping - Single Stock Analysis ( Using APPLE stock)</h3>
<h3 id="candlestick-chart">5.1 Candlestick Chart</h3>
<h4 id="candlestick-chart--complete-period">5.1.1 Candlestick Chart- Complete Period</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AAPL</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_candlestick</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>open <span class='op'>=</span> <span class='va'>open</span>, high <span class='op'>=</span> <span class='va'>high</span>, low <span class='op'>=</span> <span class='va'>low</span>, close <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"AAPL Candlestick Chart"</span>, y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_color_tq</span><span class='op'>(</span>theme <span class='op'>=</span> <span class='st'>"dark"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/label_dollar.html'>dollar</a></span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<p><strong><em>KEY LEARNING</em></strong> : A candlestick chart for a long period eg. more than 5 years is not really meaningful. THe user will need to able to zoom into the prefered periods eg. 6 weeks or less.</p>
<h4 id="candlestick-chart--zooming-into-a-6-week-window.">5.1.2 Candlestick Chart- Zooming into a 6 week window.</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AAPL</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_candlestick</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>open <span class='op'>=</span> <span class='va'>open</span>, high <span class='op'>=</span> <span class='va'>high</span>, low <span class='op'>=</span> <span class='va'>low</span>, close <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"AAPL Candlestick Chart"</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"Zoomed in using coord_x_date- 6 weeks"</span>,
         y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>end</span> <span class='op'>-</span> <span class='fu'>weeks</span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, <span class='va'>end</span><span class='op'>)</span>,
                 ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>110</span>, <span class='fl'>140</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_color_tq</span><span class='op'>(</span>theme <span class='op'>=</span> <span class='st'>"dark"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/label_dollar.html'>dollar</a></span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-6-1.png" width="624" /></p>
</div>
<h4 id="candlestick-chart--zooming-into-1-week">5.1.3 Candlestick Chart- Zooming into 1 week</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AAPL</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_candlestick</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>open <span class='op'>=</span> <span class='va'>open</span>, high <span class='op'>=</span> <span class='va'>high</span>, low <span class='op'>=</span> <span class='va'>low</span>, close <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"AAPL Candlestick Chart"</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"Zoomed in using coord_x_date - 14 days"</span>,
         y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>end</span> <span class='op'>-</span> <span class='fu'>weeks</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>, <span class='va'>end</span><span class='op'>)</span>,
                 ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>115</span>, <span class='fl'>130</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_color_tq</span><span class='op'>(</span>theme <span class='op'>=</span> <span class='st'>"dark"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/label_dollar.html'>dollar</a></span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-7-1.png" width="624" /></p>
</div>
<h4 id="candlestick-chart--using-different-colours-for-the-candlesticks.">5.1.4 Candlestick Chart- Using different colours for the candlesticks.</h4>
<p>The colors can be modified using colour_up and colour_down, which control the line color, and fill_up and fill_down, which control the rectangle fills.Using RED and GREEN - makes it very clear for the user.. which is the ‘danger’ candlestick.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AAPL</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_candlestick</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>open <span class='op'>=</span> <span class='va'>open</span>, high <span class='op'>=</span> <span class='va'>high</span>, low <span class='op'>=</span> <span class='va'>low</span>, close <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span>,
                        colour_up <span class='op'>=</span> <span class='st'>"darkgreen"</span>, colour_down <span class='op'>=</span> <span class='st'>"darkred"</span>, 
                        fill_up  <span class='op'>=</span> <span class='st'>"darkgreen"</span>, fill_down  <span class='op'>=</span> <span class='st'>"darkred"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"AAPL Candlestick Chart- 6 weeks "</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"Zoomed in, Experimenting with Formatting: dark red and dark green gives the best visual"</span>,
         y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>end</span> <span class='op'>-</span> <span class='fu'>weeks</span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, <span class='va'>end</span><span class='op'>)</span>,
                 ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>110</span>, <span class='fl'>140</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
</div>
<p><strong><em>KEY LEARNING</em></strong> : Red and Green is a good colour palette to immediately show up the days where the closing price was lower then the opening price ( Red )- makes the candle chart quickly readable.</p>
<h4 id="price-bar-chart--alternative-to-candlestick">5.1.5 Price Bar Chart- alternative to candlestick</h4>
<p>Price Bar Chart - Each bar typically shows open, high, low, and closing (OHLC) prices. Bar charts are very similar to candlestick charts. The two chart types show the same information but in different ways. A bar chart is composed of a vertical line with small horizontal lines on the left and right that show the open and close. Candlesticks also have a vertical line showing the high and low of the period (called a shadow or wick), but the difference between the open and close is represented by a thicker portion called a real body. The body is shaded in or colored red if the close is below the open. The body is white or green if the close is above the open. While the information is the same, the visual look of the two chart types is different.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AAPL</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_barchart</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>open <span class='op'>=</span> <span class='va'>open</span>, high <span class='op'>=</span> <span class='va'>high</span>, low <span class='op'>=</span> <span class='va'>low</span>, close <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"AAPL Bar Chart -Stock Prices"</span>,
         subtitle <span class='op'>=</span> <span class='st'>"The bar chart does not give move meaningful info then the line chart for large time scales"</span>,
         y <span class='op'>=</span> <span class='st'>"Closing Price in USD"</span>, x <span class='op'>=</span> <span class='st'>")+
         "</span><span class='op'>)</span><span class='op'>+</span>
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<p><strong><em>KEY LEARNING</em></strong> : The bar chart does not give move meaningful info then the line chart for large time scales</p>
<h4 id="price-barchart--for-4-weeks---zoomed-in">5.1.6 Price BarChart- for 4 weeks - zoomed in</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AAPL</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_barchart</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>open <span class='op'>=</span> <span class='va'>open</span>, high <span class='op'>=</span> <span class='va'>high</span>, low <span class='op'>=</span> <span class='va'>low</span>, close <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span>,
                  colour_up <span class='op'>=</span> <span class='st'>"darkgreen"</span>, colour_down <span class='op'>=</span> <span class='st'>"darkred"</span>, size <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"AAPL Bar Chart of Stock Prices"</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"Zoomed in using coord_x_date- colour_up = darkgreen, colour_down = darkred"</span>,
         y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>end</span> <span class='op'>-</span> <span class='fu'>weeks</span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span>, <span class='va'>end</span><span class='op'>)</span>,
                 ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>110</span>, <span class='fl'>130</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
     <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-10-1.png" width="624" /></p>
</div>
<p><strong><em>Key Learning</em></strong> :Candle Charts far easier to interpret than Pricebarcharts and much easier to read.</p>
<h3 id="stock-pricetradingvolumereturns">5.2 Stock Price/TradingVolume/Returns</h3>
<p>Exploring the varies ways to visualize Price/TradingVolume/Returns/Moving Averages.</p>
<h4 id="price-line-chart--for-the-full-period">5.2.1 Price Line Chart- for the full period</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AAPL</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_line</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"AAPL Line Chart- Prices"</span>, y <span class='op'>=</span> <span class='st'>"Closing Price in USD"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-11-1.png" width="624" /></p>
</div>
<h4 id="stock-volume-chart">5.2.2 Stock Volume Chart</h4>
<p>We can use the <strong>geom_segment()</strong> function to chart daily volume, which uses xy points for the beginning and end of the line. Using the aesthetic color argument, we color based on the value of volume to make these data stick out.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AAPL</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>volume</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_segment</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>xend <span class='op'>=</span> <span class='va'>date</span>, yend <span class='op'>=</span> <span class='fl'>0</span>, color <span class='op'>=</span> <span class='va'>volume</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"loess"</span>, se <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"APPLE Volume Chart - Bar Chart - Whole Period"</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"Charting Daily Volume"</span>, 
         y <span class='op'>=</span> <span class='st'>"Volume"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<h4 id="volume-chart---using-geom_segment--zoomed-into-past-50-days">5.2.3 Volume Chart - using Geom_segment- zoomed into past 50 days</h4>
<p>And, we can zoom in on a specific region. Using scale_color_gradient we can quickly visualize the high and low points, and using geom_smooth we can see the trend.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>start</span> <span class='op'>&lt;-</span> <span class='va'>end</span> <span class='op'>-</span> <span class='fu'>weeks</span><span class='op'>(</span><span class='fl'>24</span><span class='op'>)</span>

<span class='va'>AAPL</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;=</span> <span class='va'>start</span> <span class='op'>-</span> <span class='fu'>days</span><span class='op'>(</span><span class='fl'>20</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>volume</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_segment</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>xend <span class='op'>=</span> <span class='va'>date</span>, yend <span class='op'>=</span> <span class='fl'>0</span>, color <span class='op'>=</span> <span class='va'>volume</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"loess"</span>, se <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"APPLE Price Chart - Bar Chart- WHole Period"</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"Charting Daily Volume, Zooming In to past 20 days"</span>, 
         y <span class='op'>=</span> <span class='st'>"Volume"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>start</span>, <span class='va'>end</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_color_gradient</span><span class='op'>(</span>low <span class='op'>=</span> <span class='st'>"red"</span>, high <span class='op'>=</span> <span class='st'>"darkblue"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-13-1.png" width="624" /></p>
</div>
<h4 id="single-stock-returns-chart---line-charttime-series.">5.2.4 Single Stock Returns Chart - Line Chart/Time series.</h4>
<p>Showing monthly return for single stock</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'>tq_get</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"AAPL"</span><span class='op'>)</span>, get<span class='op'>=</span><span class='st'>"stock.prices"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>tq_transmute</span><span class='op'>(</span>select<span class='op'>=</span><span class='va'>adjusted</span>,
               mutate_fun<span class='op'>=</span><span class='va'>periodReturn</span>,
               period<span class='op'>=</span><span class='st'>"monthly"</span>,
               col_rename <span class='op'>=</span> <span class='st'>"monthly_return"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>monthly_return</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"APPLE STOCK-Monthly Return - Line Chart"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_line</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<h4 id="moving-averages">5.2.5 Moving Averages</h4>
<p>Visualizing Trends averages is important for time-series analysis of stocks. For example : A simple moving average (SMA) calculates the average of a selected range of prices, usually closing prices, by the number of periods in that range. A simple moving average is a technical indicator that can aid in determining if an asset price will continue or if it will reverse a bull or bear trend.A simple moving average can be enhanced as an exponential moving average (EMA) that is more heavily weighted on recent price action.</p>
<p>Tidyquant includes geoms to enable “rapid prototyping” to quickly visualize signals using moving averages and Bollinger bands.</p>
<p>Within Tidyquant the following moving averages are available:</p>
<p>1)Simple moving averages (SMA) 2)Exponential moving averages (EMA)</p>
<p>.. and more advanced averages : 3)Weighted moving averages (WMA) 4)Double exponential moving averages (DEMA) 5)Zero-lag exponential moving averages (ZLEMA) 6)Volume-weighted moving averages (VWMA) (also known as VWAP) 7)Elastic, volume-weighted moving averages (EVWMA) (also known as MVWAP)</p>
<p>For exploration : We will visualize the SMA, EMA.</p>
<h5 id="charting-the-14-day50-day-and-200-day-simple-moving-average">5.2.5.1 Charting the 14-day,50-day and 200-day Simple Moving Average</h5>
<p>Charting the 50-day and 200-day simple moving average using the SMA funciton as an example.We apply the moving average geoms after the candlestick geom to overlay the moving averages on top of the candlesticks. We add two moving average calls, one for the 50-day and the other for the 200-day. We add color = “red” and linetype = 5 to distinguish the 200-day from the 50-day.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AAPL</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_candlestick</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>open <span class='op'>=</span> <span class='va'>open</span>, high <span class='op'>=</span> <span class='va'>high</span>, low <span class='op'>=</span> <span class='va'>low</span>, close <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_ma</span><span class='op'>(</span>ma_fun <span class='op'>=</span> <span class='va'>SMA</span>, n <span class='op'>=</span> <span class='fl'>14</span>, color<span class='op'>=</span> <span class='st'>'green'</span>, size <span class='op'>=</span> <span class='fl'>1.25</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_ma</span><span class='op'>(</span>ma_fun <span class='op'>=</span> <span class='va'>SMA</span>, n <span class='op'>=</span> <span class='fl'>50</span>, color<span class='op'>=</span> <span class='st'>'blue'</span>, size <span class='op'>=</span> <span class='fl'>1.25</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_ma</span><span class='op'>(</span>ma_fun <span class='op'>=</span> <span class='va'>SMA</span>, n <span class='op'>=</span> <span class='fl'>200</span>, color <span class='op'>=</span> <span class='st'>"red"</span>, size <span class='op'>=</span> <span class='fl'>1.25</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"AAPL Candlestick Chart"</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"14-Day SMA(green),50-Day SMA(blue) and 200-DaySMA (red )"</span>, 
         y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>end</span> <span class='op'>-</span> <span class='fu'>weeks</span><span class='op'>(</span><span class='fl'>24</span><span class='op'>)</span>, <span class='va'>end</span><span class='op'>)</span>,
                 ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>80</span>, <span class='fl'>160</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-15-1.png" width="624" /></p>
</div>
<h5 id="charting-exponential-moving-average-ema">5.2.5.2 Charting Exponential Moving Average (EMA)</h5>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AAPL</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_barchart</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>open <span class='op'>=</span> <span class='va'>open</span>, high <span class='op'>=</span> <span class='va'>high</span>, low <span class='op'>=</span> <span class='va'>low</span>, close <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_ma</span><span class='op'>(</span>ma_fun <span class='op'>=</span> <span class='va'>EMA</span>, n <span class='op'>=</span> <span class='fl'>50</span>, wilder <span class='op'>=</span> <span class='cn'>TRUE</span>, linetype <span class='op'>=</span> <span class='fl'>5</span>, size <span class='op'>=</span> <span class='fl'>1.25</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_ma</span><span class='op'>(</span>ma_fun <span class='op'>=</span> <span class='va'>EMA</span>, n <span class='op'>=</span> <span class='fl'>200</span>, wilder <span class='op'>=</span> <span class='cn'>TRUE</span>, color <span class='op'>=</span> <span class='st'>"red"</span>, size <span class='op'>=</span> <span class='fl'>1.25</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"AAPL Bar Chart"</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"50 (Blue) and 200-Day (Red) EMA "</span>, 
         y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>end</span> <span class='op'>-</span> <span class='fu'>weeks</span><span class='op'>(</span><span class='fl'>24</span><span class='op'>)</span>, <span class='va'>end</span><span class='op'>)</span>,
                 ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>80</span>, <span class='fl'>160</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-16-1.png" width="624" /></p>
</div>
<h5 id="charting-for-reviewing-stock-volatility---bolingar-bands">5.2.5.3 Charting for Reviewing Stock Volatility - Bolingar Bands</h5>
<p>WHy Bollinger Bands - Bollinger Bands are used to visualize volatility by plotting a range around a moving average typically two standard deviations up and down. Because they use a moving average, the geom_bbands function works almost identically to geom_ma. The same seven moving averages are compatible. The main difference is the addition of the standard deviation, sd, argument which is 2 by default, and the high, low and close aesthetics which are required to calculate the bands.</p>
<h5 id="applying-bbands-using-a-sma">5.2.5.4.1 Applying BBands using a SMA</h5>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AAPL</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span>, open <span class='op'>=</span> <span class='va'>open</span>,
               high <span class='op'>=</span> <span class='va'>high</span>, low <span class='op'>=</span> <span class='va'>low</span>, close <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_candlestick</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_bbands</span><span class='op'>(</span>ma_fun <span class='op'>=</span> <span class='va'>SMA</span>, sd <span class='op'>=</span> <span class='fl'>2</span>, n <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"AAPL Candlestick Chart"</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"BBands with SMA Applied"</span>, 
         y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>end</span> <span class='op'>-</span> <span class='fu'>weeks</span><span class='op'>(</span><span class='fl'>24</span><span class='op'>)</span>, <span class='va'>end</span><span class='op'>)</span>,
                 ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>80</span>, <span class='fl'>160</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-17-1.png" width="624" /></p>
</div>
<p>Modifying the appearance of Bollinger Bands</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AAPL</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span>, open <span class='op'>=</span> <span class='va'>open</span>,
               high <span class='op'>=</span> <span class='va'>high</span>, low <span class='op'>=</span> <span class='va'>low</span>, close <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_candlestick</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_bbands</span><span class='op'>(</span>ma_fun <span class='op'>=</span> <span class='va'>SMA</span>, sd <span class='op'>=</span> <span class='fl'>2</span>, n <span class='op'>=</span> <span class='fl'>20</span>, 
                linetype <span class='op'>=</span> <span class='fl'>4</span>, size <span class='op'>=</span> <span class='fl'>1</span>, alpha <span class='op'>=</span> <span class='fl'>0.2</span>, 
                fill        <span class='op'>=</span> <span class='fu'>palette_light</span><span class='op'>(</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, 
                color_bands <span class='op'>=</span> <span class='fu'>palette_light</span><span class='op'>(</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, 
                color_ma    <span class='op'>=</span> <span class='fu'>palette_light</span><span class='op'>(</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"AAPL Candlestick Chart"</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"BBands with SMA Applied, Experimenting with Formatting"</span>, 
         y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>end</span> <span class='op'>-</span> <span class='fu'>weeks</span><span class='op'>(</span><span class='fl'>24</span><span class='op'>)</span>, <span class='va'>end</span><span class='op'>)</span>,
                 ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>80</span>, <span class='fl'>160</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-18-1.png" width="624" /></p>
</div>
<h3 id="charting-for-multiple-securities">6. Charting for Multiple Securities</h3>
<p>The main fucntion here is to use <strong>facet_wrap</strong> to visualize multiple stocks at the same time. By adding a group aesthetic in the main ggplot() function and combining with a facet_wrap() function at the end of the ggplot workflow, all five “FAANG” stocks can be viewed simultaneously.</p>
<h3 id="multiple-securities--closing-prices">6.1 Multiple securities -Closing prices</h3>
<h4 id="multiple-securities---closing-prices---in-a-timeseries-line-chart">6.1.1 Multiple securities - closing prices - in a Timeseries Line Chart</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'>tq_get</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GOOG"</span>,<span class='st'>"AMZN"</span>,<span class='st'>"FB"</span>,<span class='st'>"AAPL"</span>,<span class='st'>"NFLX"</span><span class='op'>)</span>,get<span class='op'>=</span><span class='st'>"stock.prices"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>close</span>, color<span class='op'>=</span><span class='va'>symbol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-19-1.png" width="624" /></p>
</div>
<h4 id="multiple-securities---closing-prices---in-facet">6.1.2 Multiple securities - closing prices - in Facet</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>start</span> <span class='op'>&lt;-</span> <span class='va'>end</span> <span class='op'>-</span> <span class='fu'>weeks</span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>FAANG</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;=</span> <span class='va'>start</span> <span class='op'>-</span> <span class='fu'>days</span><span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span>, group <span class='op'>=</span> <span class='va'>symbol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_candlestick</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>open <span class='op'>=</span> <span class='va'>open</span>, high <span class='op'>=</span> <span class='va'>high</span>, low <span class='op'>=</span> <span class='va'>low</span>, close <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"FAANG Candlestick Chart"</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"Experimenting with Mulitple Stocks"</span>,
         y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>start</span>, <span class='va'>end</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>symbol</span>, ncol <span class='op'>=</span> <span class='fl'>2</span>, scale <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-21-1.png" width="624" /></p>
</div>
<h3 id="multiple-securities--moving-averages-for-multiple-stocks-at-once">6.2 Multiple securities -Moving averages for multiple stocks at once</h3>
<p>Experimenting with plotting multiple moving averages.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>start</span> <span class='op'>&lt;-</span> <span class='va'>end</span> <span class='op'>-</span> <span class='fu'>weeks</span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>

<span class='va'>FAANG</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;=</span> <span class='va'>start</span> <span class='op'>-</span> <span class='fu'>days</span><span class='op'>(</span><span class='fl'>6</span> <span class='op'>*</span> <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span>, volume <span class='op'>=</span> <span class='va'>volume</span>, group <span class='op'>=</span> <span class='va'>symbol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_candlestick</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>open <span class='op'>=</span> <span class='va'>open</span>, high <span class='op'>=</span> <span class='va'>high</span>, low <span class='op'>=</span> <span class='va'>low</span>, close <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_ma</span><span class='op'>(</span>ma_fun <span class='op'>=</span> <span class='va'>SMA</span>, n <span class='op'>=</span> <span class='fl'>14</span>, color<span class='op'>=</span> <span class='st'>'green'</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_ma</span><span class='op'>(</span>ma_fun <span class='op'>=</span> <span class='va'>SMA</span>, n <span class='op'>=</span> <span class='fl'>50</span>, color<span class='op'>=</span> <span class='st'>'blue'</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_ma</span><span class='op'>(</span>ma_fun <span class='op'>=</span> <span class='va'>SMA</span>, n <span class='op'>=</span> <span class='fl'>200</span>, color <span class='op'>=</span> <span class='st'>"red"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Multiple Securities : FAANG "</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"15 and 50-Day EMA, Experimenting with Multiple Stocks"</span>, 
         y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>start</span>, <span class='va'>end</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>symbol</span>, ncol <span class='op'>=</span> <span class='fl'>2</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-22-1.png" width="624" /></p>
</div>
<p><strong><em>KEY LEARNING</em></strong> : It doesn’t make sense to plot multiple moving average days in one combined visual.. as the lines are too close to visualize.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>start</span> <span class='op'>&lt;-</span> <span class='va'>end</span> <span class='op'>-</span> <span class='fu'>weeks</span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>

<span class='va'>FAANG</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;=</span> <span class='va'>start</span> <span class='op'>-</span> <span class='fu'>days</span><span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span>, volume <span class='op'>=</span> <span class='va'>volume</span>, group <span class='op'>=</span> <span class='va'>symbol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_candlestick</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>open <span class='op'>=</span> <span class='va'>open</span>, high <span class='op'>=</span> <span class='va'>high</span>, low <span class='op'>=</span> <span class='va'>low</span>, close <span class='op'>=</span> <span class='va'>close</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_ma</span><span class='op'>(</span>ma_fun <span class='op'>=</span> <span class='va'>SMA</span>, n <span class='op'>=</span> <span class='fl'>15</span>, color<span class='op'>=</span> <span class='st'>'blue'</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Multiple Securities : FAANG "</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"30-Day SMA, Experimenting with Multiple Stocks"</span>, 
         y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>start</span>, <span class='va'>end</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>symbol</span>, ncol <span class='op'>=</span> <span class='fl'>2</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-23-1.png" width="624" /></p>
</div>
<p>*** KEY LEARNING *** FAANG data is filtered by date from double the number of moving-average days (2 * n) previous to the start date. This yields a nice y-axis scale and still allows us to create a moving average line using geom_ma.Too much out-of-bounds data distorts the scale of the y-axis, and too little and we cannot get a moving average. The optimal method is to include “just enough” out-of-bounds data to get the chart we want.</p>
<h3 id="multiple-securities--bbands-for-multiple-stocks">6.3 Multiple securities -BBands for multiple stocks</h3>
<p>This is to try out the <strong>geom_bbands</strong> and <strong>facet_wrap</strong> functions.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>start</span> <span class='op'>&lt;-</span> <span class='va'>end</span> <span class='op'>-</span> <span class='fu'>weeks</span><span class='op'>(</span><span class='fl'>24</span><span class='op'>)</span>
<span class='va'>FAANG</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;=</span> <span class='va'>start</span> <span class='op'>-</span> <span class='fu'>days</span><span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='fl'>20</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span>, 
               open <span class='op'>=</span> <span class='va'>open</span>, high <span class='op'>=</span> <span class='va'>high</span>, low <span class='op'>=</span> <span class='va'>low</span>, close <span class='op'>=</span> <span class='va'>close</span>, 
               group <span class='op'>=</span> <span class='va'>symbol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_barchart</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_bbands</span><span class='op'>(</span>ma_fun <span class='op'>=</span> <span class='va'>SMA</span>, sd <span class='op'>=</span> <span class='fl'>2</span>, n <span class='op'>=</span> <span class='fl'>20</span>, linetype <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Multiple Securities : FAANG "</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"BBands with SMA Applied, Experimenting with Multiple Stocks"</span>, 
         y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>start</span>, <span class='va'>end</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>symbol</span>, ncol <span class='op'>=</span> <span class='fl'>2</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-24-1.png" width="624" /></p>
</div>
<h3 id="multiple-securities--annural-returns">6.4 Multiple securities -Annural Returns</h3>
<h4 id="multiple-stocks-in-a-one-line-chart">6.4.1 Multiple Stocks in a one line chart</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'>tq_get</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GOOGL"</span>,<span class='st'>"AMZN"</span>,<span class='st'>"FB"</span>,<span class='st'>"AAPL"</span>,<span class='st'>"NFLX"</span><span class='op'>)</span>, get<span class='op'>=</span><span class='st'>"stock.prices"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>symbol</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>tq_transmute</span><span class='op'>(</span>select<span class='op'>=</span><span class='va'>adjusted</span>,
               mutate_fun<span class='op'>=</span><span class='va'>periodReturn</span>,
               period<span class='op'>=</span><span class='st'>"monthly"</span>,
               col_rename <span class='op'>=</span> <span class='st'>"monthly_return"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>monthly_return</span>, color<span class='op'>=</span><span class='va'>symbol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Multiple Securities : FAANG - in one line chart"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_line</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-25-1.png" width="624" /></p>
</div>
<p>*<strong>KEY LEARNING</strong> From the chart we can see that NETFLIX had much bigger swings in return than the overstocks. For a deeper dive comparison, a facet layout will be required side by side.</p>
<h4 id="multiple-stocks-in-a-facet-layout">6.4.2 Multiple Stocks in a Facet Layout</h4>
<p>This is to try out the <strong>tq_transmute</strong> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>FAANG_annual_returns</span> <span class='op'>&lt;-</span> <span class='va'>FAANG</span> <span class='op'>%&gt;%</span>
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>symbol</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>tq_transmute</span><span class='op'>(</span>select     <span class='op'>=</span> <span class='va'>adjusted</span>, 
                 mutate_fun <span class='op'>=</span> <span class='va'>periodReturn</span>, 
                 period     <span class='op'>=</span> <span class='st'>"yearly"</span>, 
                 type       <span class='op'>=</span> <span class='st'>"arithmetic"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>FAANG_annual_returns</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>yearly.returns</span>, fill <span class='op'>=</span> <span class='va'>symbol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_col</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_hline</span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>, color <span class='op'>=</span> <span class='fu'>palette_light</span><span class='op'>(</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/label_percent.html'>percent</a></span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"FAANG: Annual Returns"</span>,
         subtitle <span class='op'>=</span> <span class='st'>"Get annual returns quickly with tq_transmute!"</span>,
         y <span class='op'>=</span> <span class='st'>"Annual Returns"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>symbol</span>, ncol <span class='op'>=</span> <span class='fl'>2</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>scale_fill_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-27-1.png" width="624" /></p>
</div>
<h3 id="portfolio-analysis-using-tq_portfolio-function.">6.5 Portfolio Analysis using <strong><em>tq_portfolio</em></strong> function.</h3>
<h4 id="portfolio-returns">6.5.1 Portfolio Returns</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>stock_returns_monthly</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"AAPL"</span>, <span class='st'>"GOOG"</span>, <span class='st'>"NFLX"</span>,<span class='st'>"FB"</span>,<span class='st'>"AMZN"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>tq_get</span><span class='op'>(</span>get  <span class='op'>=</span> <span class='st'>"stock.prices"</span>,
           from <span class='op'>=</span> <span class='st'>"2010-01-01"</span>,
           to   <span class='op'>=</span> <span class='st'>"2015-12-31"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>symbol</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>tq_transmute</span><span class='op'>(</span>select     <span class='op'>=</span> <span class='va'>adjusted</span>, 
                 mutate_fun <span class='op'>=</span> <span class='va'>periodReturn</span>, 
                 period     <span class='op'>=</span> <span class='st'>"monthly"</span>, 
                 col_rename <span class='op'>=</span> <span class='st'>"Ra"</span><span class='op'>)</span>
<span class='va'>wts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.2</span>, <span class='fl'>0.2</span>,<span class='fl'>0.2</span>,<span class='fl'>0.2</span><span class='op'>)</span>
<span class='va'>portfolio_returns_monthly</span> <span class='op'>&lt;-</span> <span class='va'>stock_returns_monthly</span> <span class='op'>%&gt;%</span>
    <span class='fu'>tq_portfolio</span><span class='op'>(</span>assets_col  <span class='op'>=</span> <span class='va'>symbol</span>, 
                 returns_col <span class='op'>=</span> <span class='va'>Ra</span>, 
                 weights     <span class='op'>=</span> <span class='va'>wts</span>, 
                 col_rename  <span class='op'>=</span> <span class='st'>"Ra"</span><span class='op'>)</span>


<span class='va'>portfolio_returns_monthly</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>Ra</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_bar</span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>, fill <span class='op'>=</span> <span class='fu'>palette_light</span><span class='op'>(</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Portfolio Returns"</span>,
         subtitle <span class='op'>=</span> <span class='st'>"20% AAPL, 20% GOOG,20% NFLX, 20% FB, 20% AMZN"</span>,
         caption <span class='op'>=</span> <span class='st'>"Shows an above-zero trend meaning positive returns"</span>,
         x <span class='op'>=</span> <span class='st'>""</span>, y <span class='op'>=</span> <span class='st'>"Monthly Returns"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_color_tq</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/label_percent.html'>percent</a></span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-28-1.png" width="624" /></p>
</div>
<h4 id="portfolio-growth">6.5.2 Portfolio Growth</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>wts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>,<span class='fl'>0.2</span>,<span class='fl'>0.2</span>,<span class='fl'>0.2</span>,<span class='fl'>0.2</span><span class='op'>)</span>
<span class='va'>portfolio_growth_monthly</span> <span class='op'>&lt;-</span> <span class='va'>stock_returns_monthly</span> <span class='op'>%&gt;%</span>
    <span class='fu'>tq_portfolio</span><span class='op'>(</span>assets_col   <span class='op'>=</span> <span class='va'>symbol</span>, 
                 returns_col  <span class='op'>=</span> <span class='va'>Ra</span>, 
                 weights      <span class='op'>=</span> <span class='va'>wts</span>, 
                 col_rename   <span class='op'>=</span> <span class='st'>"investment.growth"</span>,
                 wealth.index <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>investment.growth <span class='op'>=</span> <span class='va'>investment.growth</span> <span class='op'>*</span> <span class='fl'>10000</span><span class='op'>)</span>

<span class='va'>portfolio_growth_monthly</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>investment.growth</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_line</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>1.5</span>, color <span class='op'>=</span> <span class='fu'>palette_light</span><span class='op'>(</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Portfolio Growth"</span>,
         subtitle <span class='op'>=</span> <span class='st'>"20% AAPL, 20% GOOG,20% NFLX, 20% FB, 20% AMZN"</span>,
         caption <span class='op'>=</span> <span class='st'>"Visualize performance!"</span>,
         x <span class='op'>=</span> <span class='st'>""</span>, y <span class='op'>=</span> <span class='st'>"Portfolio Value"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"loess"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_color_tq</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/label_dollar.html'>dollar</a></span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-29-1.png" width="624" /></p>
</div>
<h4 id="visualizing-multiple-portfolios">6.5.3 Visualizing Multiple Portfolios</h4>
<p>To visualize multiple portfolios, we just need to configure the WEIGHTs table, for the chosen number of 3 stocks.</p>
<p>20% AAPL, 25% GOOG, 25% NFLX, 20% FB,10% AMZN 15% AAPL, 50% GOOG, 25% NFLX, 5% FB,5% AMZN 15% AAPL, 25% GOOG, 40% NFLX, 10% FB,10% AMZN</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>weights</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
    <span class='fl'>0.2</span>, <span class='fl'>0.25</span>, <span class='fl'>0.25</span>,<span class='fl'>0.2</span>,<span class='fl'>0.1</span>,
    <span class='fl'>0.10</span>, <span class='fl'>0.40</span>, <span class='fl'>0.3</span>,<span class='fl'>0.1</span>,<span class='fl'>0.1</span>,
    <span class='fl'>0.15</span>, <span class='fl'>0.25</span>, <span class='fl'>0.40</span>,<span class='fl'>0.1</span>,<span class='fl'>0.1</span>
<span class='op'>)</span>

<span class='va'>stocks</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"AAPL"</span>, <span class='st'>"GOOG"</span>, <span class='st'>"NFLX"</span>,<span class='st'>"FB"</span>,<span class='st'>"AMZN"</span><span class='op'>)</span>

<span class='va'>weights_table</span> <span class='op'>&lt;-</span>  <span class='fu'>tibble</span><span class='op'>(</span><span class='va'>stocks</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>tq_repeat_df</span><span class='op'>(</span>n <span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>bind_cols</span><span class='op'>(</span><span class='fu'>tibble</span><span class='op'>(</span><span class='va'>weights</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>portfolio</span><span class='op'>)</span>

<span class='va'>stock_returns_monthly_multi</span> <span class='op'>&lt;-</span> <span class='va'>stock_returns_monthly</span> <span class='op'>%&gt;%</span>
    <span class='fu'>tq_repeat_df</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>

<span class='va'>portfolio_growth_monthly_multi</span> <span class='op'>&lt;-</span> <span class='va'>stock_returns_monthly_multi</span> <span class='op'>%&gt;%</span>
    <span class='fu'>tq_portfolio</span><span class='op'>(</span>assets_col   <span class='op'>=</span> <span class='va'>symbol</span>, 
                 returns_col  <span class='op'>=</span> <span class='va'>Ra</span>, 
                 weights      <span class='op'>=</span> <span class='va'>weights_table</span>, 
                 col_rename   <span class='op'>=</span> <span class='st'>"investment.growth"</span>,
                 wealth.index <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>investment.growth <span class='op'>=</span> <span class='va'>investment.growth</span> <span class='op'>*</span> <span class='fl'>10000</span><span class='op'>)</span>



<span class='va'>portfolio_growth_monthly_multi</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>investment.growth</span>, color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>portfolio</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_line</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Portfolio Growth"</span>,
         subtitle <span class='op'>=</span> <span class='st'>"Comparing Multiple Portfolios- Portfolio 2 has the highest returns"</span>,
         caption <span class='op'>=</span> <span class='st'>"Best Performing Porfolio -3 : 15% AAPL, 25% GOOG, 40% NFLX,10% FB,10% AMZN"</span>,
         x <span class='op'>=</span> <span class='st'>""</span>, y <span class='op'>=</span> <span class='st'>"Portfolio Value"</span>,
         color <span class='op'>=</span> <span class='st'>"Portfolio"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"loess"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_color_tq</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/label_dollar.html'>dollar</a></span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-30-1.png" width="624" /></p>
</div>
<h3 id="miscelleneous-plotting-experiementations">6.6 Miscelleneous Plotting experiementations</h3>
<h3 id="ggplot---exploration-of-log-scale-vs-continous-scale-on-y-for-stock-prices">6.6.1 GGPLOT - Exploration of Log Scale vs Continous Scale on Y for stock prices</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AMZN</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>adjusted</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_line</span><span class='op'>(</span>color <span class='op'>=</span> <span class='fu'>palette_light</span><span class='op'>(</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>scale_y_continuous</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"AMZN Line Chart"</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"Continuous Scale"</span>, 
         y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-31-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AMZN</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>adjusted</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_line</span><span class='op'>(</span>color <span class='op'>=</span> <span class='fu'>palette_light</span><span class='op'>(</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>scale_y_log10</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"AMZN Line Chart"</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"Log Scale"</span>, 
         y <span class='op'>=</span> <span class='st'>"Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-32-1.png" width="624" /></p>
</div>
<h3 id="ggplot---plotting-regression-trendlines-with-geom_smooth">6.6.2 GGPLOT - Plotting Regression trendlines with geom_smooth</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>AMZN</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>adjusted</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_line</span><span class='op'>(</span>color <span class='op'>=</span> <span class='fu'>palette_light</span><span class='op'>(</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>scale_y_log10</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"AMZN Line Chart"</span>, 
         subtitle <span class='op'>=</span> <span class='st'>"Log Scale, Applying Linear Trendline"</span>, 
         y <span class='op'>=</span> <span class='st'>"Adjusted Closing Price"</span>, x <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-33-1.png" width="624" /></p>
</div>
<h4 id="tidyquant-themes">6.6.3 Tidyquant Themes</h4>
<h4 id="testing-with-dark-theme-and-thin-lines">6.6.3.1 Testing with Dark Theme and thin lines</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>n_mavg</span> <span class='op'>&lt;-</span> <span class='fl'>50</span> <span class='co'># Number of periods (days) for moving average</span>
<span class='va'>FAANG</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;=</span> <span class='va'>start</span> <span class='op'>-</span> <span class='fu'>days</span><span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='va'>n_mavg</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span>, color <span class='op'>=</span> <span class='va'>symbol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_line</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_ma</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>15</span>, color <span class='op'>=</span> <span class='st'>"darkblue"</span>, size <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>geom_ma</span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>n_mavg</span>, color <span class='op'>=</span> <span class='st'>"red"</span>, size <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Dark Theme and thin lines- size 0.2"</span>,
         x <span class='op'>=</span> <span class='st'>""</span>, y <span class='op'>=</span> <span class='st'>"Closing Price"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>start</span>, <span class='va'>end</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>symbol</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme_tq_dark</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_color_tq</span><span class='op'>(</span>theme <span class='op'>=</span> <span class='st'>"dark"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/label_dollar.html'>dollar</a></span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-34-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>n_mavg</span> <span class='op'>&lt;-</span> <span class='fl'>50</span> <span class='co'># Number of periods (days) for moving average</span>
<span class='va'>FAANG</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;=</span> <span class='va'>start</span> <span class='op'>-</span> <span class='fu'>days</span><span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='va'>n_mavg</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span>, color <span class='op'>=</span> <span class='va'>symbol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_line</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_ma</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>15</span>, color <span class='op'>=</span> <span class='st'>"darkblue"</span>, size <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>geom_ma</span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>n_mavg</span>, color <span class='op'>=</span> <span class='st'>"red"</span>, size <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Light Theme with thicker lines of size -1.5"</span>,
         x <span class='op'>=</span> <span class='st'>""</span>, y <span class='op'>=</span> <span class='st'>"Closing Price"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>start</span>, <span class='va'>end</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>symbol</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme_tq</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_color_tq</span><span class='op'>(</span>theme <span class='op'>=</span> <span class='st'>"dark"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/label_dollar.html'>dollar</a></span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-35-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>n_mavg</span> <span class='op'>&lt;-</span> <span class='fl'>50</span> <span class='co'># Number of periods (days) for moving average</span>
<span class='va'>FAANG</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;=</span> <span class='va'>start</span> <span class='op'>-</span> <span class='fu'>days</span><span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='va'>n_mavg</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y <span class='op'>=</span> <span class='va'>close</span>, color <span class='op'>=</span> <span class='va'>symbol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_line</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_ma</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>15</span>, color <span class='op'>=</span> <span class='st'>"darkblue"</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>geom_ma</span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>n_mavg</span>, color <span class='op'>=</span> <span class='st'>"red"</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Green Theme with normal size line"</span>,
         x <span class='op'>=</span> <span class='st'>""</span>, y <span class='op'>=</span> <span class='st'>"Closing Price"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>coord_x_date</span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>start</span>, <span class='va'>end</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>symbol</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme_tq_green</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_color_tq</span><span class='op'>(</span>theme <span class='op'>=</span> <span class='st'>"dark"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/label_dollar.html'>dollar</a></span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="assignment_files/figure-html5/unnamed-chunk-36-1.png" width="624" /></p>
</div>
<p><strong><em>Key Learning</em></strong> : THe other colour schemes - will invariably collide with one of the coloured lines - eg. in the last example above. The <strong><em>white theme</em></strong> with normal size line of 1 is good for single charts, and for faceted charts, white background with a fine line width of about 0.8 : still presents the information with better clarity, and should be used for overall approach.</p>
<h3 id="reflection--conclusionkey-learningsbenefits-of-interactivity-in-the-shiny-app">7.0 Reflection- Conclusion/Key Learnings/Benefits of Interactivity in the Shiny App</h3>
<p>A interactive implementation of the above would be able to bring much better user experience. Based on experimenting with various formats, graph and chart options i think :</p>
<p>a)Candle-stick is clearer for the user to read then barchart</p>
<p>b)Facets provide possiblity to read the details per stock ( when comparing a portofolio of stocks ) and should be provided as an additional option in addition to the typical ‘one chart’.</p>
<p>c)The default theme ‘white’ is much clearer than the fancier color schemes such as grey/green.</p>
<p>d)THe log-scale for y-axis eg. for stock prices although allowing more to be captured, can be misleading and is not recommended to be used for stock prices- especially for intepreting trends.</p>
<h3 id="interactive-user-experience-and-self-configuration-of-views">7.1 Interactive User Experience and Self Configuration of views</h3>
<ol type="1">
<li><p>The user will be able select the range date for “zooming” down into the chart rather than hard-coding as above. Example a candlestick chart is not meaningful over multi-years.</p></li>
<li><p>The user will be able to use a drop-down menu to select the type of charts he wish to view both for single stock or groups of stock</p></li>
<li><p>The example shows the group stock analysis for 5 chosen stocks, in an interactive implementation the user will be able to decide which stocks he wants to view and compare as a group.</p></li>
<li><p>With an interactive add the portfolio mix can also be ‘configured’ for various scenarios</p></li>
</ol>
<h3 id="finer-details---interacing-with-chart-points.">7.2 Finer details - Interacing with Chart Points.</h3>
<p>With an interactive visualisation, the user is able to see more detail about the chart, by ‘hovering’ over the chart. Currently, all values have to be ‘read off’ the grid, and the user has to estimate the X and Y values based on the grid lines, instead of knowing the exact values.</p>
<h3 id="possible-shiny-app-story-board-for-stock-analysis">8.0 Possible SHiny App Story Board for Stock Analysis</h3>
<figure>
<img src="targetshiny.jpg" alt="Origina" /><figcaption aria-hidden="true">Origina</figcaption>
</figure>
<h3 id="references">9.0 References</h3>
<p>1)Tidyquant Reference Manual : <a href="https://cloud.r-project.org/web/packages/tidyquant/tidyquant.pdf" class="uri">https://cloud.r-project.org/web/packages/tidyquant/tidyquant.pdf</a> : 5th March 2021</p>
<p>2)Introduction to TidyQuant <a href="https://cloud.r-project.org/web/packages/tidyquant/vignettes/TQ00-introduction-to-tidyquant.html" class="uri">https://cloud.r-project.org/web/packages/tidyquant/vignettes/TQ00-introduction-to-tidyquant.html</a></p>
<p>3)R Graphics Cook Book - Winston Chong</p>
<p>4)Workflow for : TidyQuant Portfolio Analysis <a href="https://cloud.r-project.org/web/packages/tidyquant/vignettes/TQ05-performance-analysis-with-tidyquant.html" class="uri">https://cloud.r-project.org/web/packages/tidyquant/vignettes/TQ05-performance-analysis-with-tidyquant.html</a></p>
<p>5)Various Examples <a href="https://edav.info/tidyquant.html" class="uri">https://edav.info/tidyquant.html</a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
